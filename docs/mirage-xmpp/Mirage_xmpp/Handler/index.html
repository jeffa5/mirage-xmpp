<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Handler (mirage-xmpp.Mirage_xmpp.Handler)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">mirage-xmpp</a> &#x00BB; <a href="../index.html">Mirage_xmpp</a> &#x00BB; Handler</nav><h1>Module <code>Mirage_xmpp.Handler</code></h1></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type </span>t</code></dt><dd><p>The type of an XMPP handler.</p></dd></dl><dl><dt class="spec value" id="val-create"><a href="#val-create" class="anchor"></a><code><span class="keyword">val </span>create : stream:char Lwt_stream.t <span>&#45;&gt;</span> callback:(string option <span>&#45;&gt;</span> unit) <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>create c r s f</code> creates a new handler. <code>c</code> is a connections table of the currently active connections to the server. <code>r</code> is the roster for the server. <code>s</code> is a stream to receive the incoming data on. <code>f</code> is a callback function which can be used to send data back to the user</p></dd></dl><dl><dt class="spec value" id="val-handle"><a href="#val-handle" class="anchor"></a><code><span class="keyword">val </span>handle : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit Lwt.t</code></dt><dd><p><code>handle t</code> takes the handler and starts handling the XMPP connection with the client.</p><p>This controls the main operation of the server:</p><ul><li>call parse_stanza on the parser which will return a new stanza</li><li>translates the received stanza into an event type and pass this to the fsm to get a new fsm</li><li>take the actions from the fsm and push necessary data to the callback function, handle roster events and perform lookups on the connections in order to send data to other users</li><li>call parse_stanza again and repeat</li></ul></dd></dl><dl><dt class="spec value" id="val-to_string"><a href="#val-to_string" class="anchor"></a><code><span class="keyword">val </span>to_string : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt></dl></div></body></html>